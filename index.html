<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nihongo Pro | Ultimate Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;600;700&family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Quicksand', sans-serif; overflow: hidden; background: #f8fafc; }
        .jp { font-family: 'Zen Maru Gothic', sans-serif; }
        
        /* ANIMATIONS */
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .float-anim { animation: float 6s ease-in-out infinite; }
        
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .slide-up { animation: slideUp 0.6s ease-out forwards; opacity: 0; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }

        /* SAKURA BACKGROUND */
        .sakura-container { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            pointer-events: none; z-index: 0; overflow: hidden;
        }

        /* 3D FLIP CARD STYLES (NEW) */
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        
        .kanji-card-inner {
            position: relative; width: 100%; height: 100%; text-align: center;
            transition: transform 0.8s; transform-style: preserve-3d;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); border-radius: 1rem;
        }
        
        .kanji-card:hover .kanji-card-inner { transform: rotateY(180deg); }
        
        .kanji-front, .kanji-back {
            position: absolute; width: 100%; height: 100%;
            -webkit-backface-visibility: hidden; backface-visibility: hidden;
            border-radius: 1rem; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }
        
        .kanji-back {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            color: white; transform: rotateY(180deg); padding: 1.5rem;
        }
        
        /* SCROLLBAR HIDING */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useRef } = React;
	/* --- CHUNK 2: KANJI DATA --- */

    const KANJI_N5 = [
        // NUMBERS
        { char: "‰∏Ä", mean: "One", on: "Ichi", kun: "Hito", trick: "Just one stroke." },
        { char: "‰∫å", mean: "Two", on: "Ni", kun: "Futa", trick: "1 + 1 = 2 (Two lines)." },
        { char: "‰∏â", mean: "Three", on: "San", kun: "Mittsu", trick: "1 + 2 = 3 (Three lines)." },
        { char: "Âõõ", mean: "Four", on: "Shi", kun: "Yon", trick: "There are four sides to a square." },
        { char: "‰∫î", mean: "Five", on: "Go", kun: "Itsu", trick: "It looks like the number 5." },
        { char: "ÂÖ≠", mean: "Six", on: "Roku", kun: "Mu", trick: "Looks like 'VI' (6) upside down." },
        { char: "‰∏É", mean: "Seven", on: "Shichi", kun: "Nana", trick: "It is a 7 inverted." },
        { char: "ÂÖ´", mean: "Eight", on: "Hachi", kun: "Ya", trick: "Follow the lines to make an '8'." },
        { char: "‰πù", mean: "Nine", on: "Kyuu", kun: "Kokono", trick: "Looks like '9' with imagination." },
        { char: "ÂçÅ", mean: "Ten", on: "Juu", kun: "Too", trick: "Roman numeral X is 10." },
        { char: "Áôæ", mean: "Hundred", on: "Hyaku", kun: "-", trick: "Rotate 100 to get Áôæ." },
        { char: "ÂçÉ", mean: "Thousand", on: "Sen", kun: "Chi", trick: "Thousand starts with T." },
        { char: "‰∏á", mean: "10,000", on: "Man", kun: "-", trick: "Capital T + h combined." },
        
        // NATURE
        { char: "Êó•", mean: "Sun/Day", on: "Nichi", kun: "Hi", trick: "Shape of the sun (squared)." },
        { char: "Êúà", mean: "Moon/Month", on: "Getsu", kun: "Tsuki", trick: "Looks like a quarter moon." },
        { char: "ÁÅ´", mean: "Fire", on: "Ka", kun: "Hi", trick: "A campfire with flames flying." },
        { char: "Ê∞¥", mean: "Water", on: "Sui", kun: "Mizu", trick: "Represents a current of water." },
        { char: "Êú®", mean: "Tree", on: "Moku", kun: "Ki", trick: "Looks like a tree with roots." },
        { char: "Èáë", mean: "Gold/Money", on: "Kin", kun: "Kane", trick: "King (Áéã) divides gold in his house." },
        { char: "Âúü", mean: "Earth", on: "Do", kun: "Tsuchi", trick: "A cross on a grave in the earth." },
        { char: "Â±±", mean: "Mountain", on: "San", kun: "Yama", trick: "Shape of mountain peaks." },
        { char: "Â∑ù", mean: "River", on: "Sen", kun: "Kawa", trick: "Three lines flowing like a river." },
        { char: "Â§©", mean: "Heaven", on: "Ten", kun: "Ama", trick: "Heaven is one (‰∏Ä) big (Â§ß) place." },
        
        // PEOPLE & DIRECTIONS
        { char: "‰∫∫", mean: "Person", on: "Jin", kun: "Hito", trick: "A man standing, legs spread." },
        { char: "Âè£", mean: "Mouth", on: "Kou", kun: "Kuchi", trick: "A mouth wide open." },
        { char: "ÁõÆ", mean: "Eye", on: "Moku", kun: "Me", trick: "Shape of an eye (vertical)." },
        { char: "ËÄ≥", mean: "Ear", on: "Ji", kun: "Mimi", trick: "An ear with a hole in the middle." },
        { char: "Êâã", mean: "Hand", on: "Shu", kun: "Te", trick: "Simplified hand giving a thumb down." },
        { char: "Âåó", mean: "North", on: "Hoku", kun: "Kita", trick: "Two people sitting back to back." },
        { char: "Êù±", mean: "East", on: "Tou", kun: "Higashi", trick: "Sun (Êó•) rising behind a tree (Êú®)." },
        { char: "Ë•ø", mean: "West", on: "Sei", kun: "Nishi", trick: "Birds nesting in the west." },
        { char: "Âçó", mean: "South", on: "Nan", kun: "Minami", trick: "A tropical plant growing south." }
    ];
	/* --- CHUNK 3: LESSON DATA & SAKURA ENGINE --- */

    const DATABASE = {
        levels: ["N5", "N4", "N3", "N2", "N1"],
        kanji: KANJI_N5,
        lessons: {
            "N5": [
                {
                    id: 1, title: "Identity & Greetings", desc: "Start here! X is Y",
                    vocab: [
                        { jp: "„Çè„Åü„Åó", romaji: "Watashi", en: "I / Me" },
                        { jp: "„Åå„Åè„Åõ„ÅÑ", romaji: "Gakusei", en: "Student" },
                        { jp: "„Åõ„Çì„Åõ„ÅÑ", romaji: "Sensei", en: "Teacher" }
                    ],
                    grammar: [
                        { title: "X wa Y desu", rule: "X „ÅØ Y „Åß„Åô", expl: "Basic sentence: 'I am a student' -> Watashi wa gakusei desu." },
                        { title: "Particle WA („ÅØ)", rule: "Topic Marker", expl: "Marks the topic. Pronounced 'wa' when used as a particle." }
                    ],
                    quiz: [
                        { q: "Translate: I am a student.", options: ["Watashi wa sensei desu", "Watashi wa gakusei desu", "Anata wa gakusei desu"], correct: 1 },
                        { q: "Which particle marks the topic?", options: ["ka („Åã)", "wa („ÅØ)", "no („ÅÆ)"], correct: 1 }
                    ]
                },
                {
                    id: 2, title: "Demonstratives", desc: "Kore, Sore, Are",
                    vocab: [
                        { jp: "„Åì„Çå", romaji: "Kore", en: "This (near me)" },
                        { jp: "„Åù„Çå", romaji: "Sore", en: "That (near you)" },
                        { jp: "„ÅÇ„Çå", romaji: "Are", en: "That (over there)" }
                    ],
                    grammar: [
                        { title: "Kore / Sore / Are", rule: "Pointing words", expl: "Kore (This), Sore (That), Are (That over there)." },
                        { title: "Ka („Åã)", rule: "Question Particle", expl: "Add 'ka' at the end to make a question." }
                    ],
                    quiz: [
                        { q: "How do you say 'This'?", options: ["Kore", "Sore", "Are"], correct: 0 },
                        { q: "What is the question particle?", options: ["Ne", "Yo", "Ka"], correct: 2 }
                    ]
                }
            ]
        }
    };

    // --- SAKURA BACKGROUND COMPONENT ---
    const SakuraBackground = () => {
        const canvasRef = useRef(null);

        useEffect(() => {
            const canvas = canvasRef.current;
            const ctx = canvas.getContext('2d');
            let animationFrameId;

            const resize = () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            };
            window.addEventListener('resize', resize);
            resize();

            const petals = Array.from({ length: 40 }, () => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 10 + 5,
                speedY: Math.random() * 1 + 0.5,
                speedX: Math.random() * 1 - 0.5,
                opacity: Math.random() * 0.5 + 0.3
            }));

            const draw = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                petals.forEach(p => {
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 183, 197, ${p.opacity})`;
                    ctx.fill();
                    p.y += p.speedY;
                    p.x += p.speedX;
                    if (p.y > canvas.height) p.y = -20;
                    if (p.x > canvas.width) p.x = 0;
                    if (p.x < 0) p.x = canvas.width;
                });
                animationFrameId = requestAnimationFrame(draw);
            };
            draw();
            return () => {
                window.removeEventListener('resize', resize);
                cancelAnimationFrame(animationFrameId);
            };
        }, []);

        return <canvas ref={canvasRef} className="sakura-container" />;
    };
	/* --- CHUNK 4: COMPONENTS (KANJI & DASHBOARD) --- */

    // 1. KANJI FLIP CARD
    const KanjiCard = ({ data }) => {
        return (
            <div className="kanji-card w-40 h-56 bg-transparent cursor-pointer perspective-1000 group">
                <div className="kanji-card-inner duration-500 relative w-full h-full border-2 border-pink-100 rounded-2xl bg-white">
                    {/* FRONT */}
                    <div className="kanji-front shadow-sm">
                        <div className="text-6xl font-black text-slate-800 mb-2 jp">{data.char}</div>
                        <div className="text-sm font-bold text-pink-500 uppercase tracking-widest">{data.mean}</div>
                        <div className="mt-4 w-full px-4">
                            <div className="flex justify-between text-xs text-slate-500 border-b border-slate-100 pb-1">
                                <span>ON:</span> <span className="font-bold">{data.on}</span>
                            </div>
                            <div className="flex justify-between text-xs text-slate-500 pt-1">
                                <span>KUN:</span> <span className="font-bold">{data.kun}</span>
                            </div>
                        </div>
                    </div>
                    {/* BACK */}
                    <div className="kanji-back">
                        <h3 className="text-pink-300 font-bold text-sm mb-2 uppercase tracking-wider">Memory Trick</h3>
                        <p className="text-sm font-medium leading-relaxed italic">"{data.trick}"</p>
                        <div className="mt-4 text-xs text-slate-400">Hover to flip back</div>
                    </div>
                </div>
            </div>
        );
    };

    // 2. KANJI DASHBOARD
    const KanjiDashboard = ({ onBack }) => {
        return (
            <div className="max-w-6xl mx-auto p-6 fade-in h-full overflow-y-auto no-scrollbar pb-32 relative z-10">
                <div className="flex items-center mb-8 sticky top-0 bg-[#f8fafc] z-20 py-4">
                    <button onClick={onBack} className="bg-white p-3 rounded-full shadow-sm hover:shadow-md transition-all mr-4 text-slate-600">
                        ‚Üê Back
                    </button>
                    <div>
                        <h1 className="text-3xl font-bold text-slate-800">N5 Kanji Master</h1>
                        <p className="text-slate-500">Hover to see memory tricks!</p>
                    </div>
                </div>
                <div className="flex flex-wrap gap-6 justify-center pb-20">
                    {DATABASE.kanji.map((k, idx) => (
                        <div key={idx} className="slide-up" style={{animationDelay: idx * 0.05 + 's'}}>
                            <KanjiCard data={k} />
                        </div>
                    ))}
                </div>
            </div>
        );
    };

    // 3. LESSON DASHBOARD (Restored)
    const LessonDashboard = ({ level, onBack, onSelectLesson }) => {
        const lessons = DATABASE.lessons[level] || [];
        return (
            <div className="p-8 max-w-4xl mx-auto fade-in relative z-10">
                <button onClick={onBack} className="mb-6 text-slate-500 hover:text-pink-500 font-bold">‚Üê Back to Home</button>
                <h2 className="text-4xl font-bold text-slate-800 mb-2">Level {level}</h2>
                <p className="text-slate-500 mb-8">Select a module to begin learning.</p>
                <div className="grid gap-4">
                    {lessons.map((l, i) => (
                        <div key={l.id} onClick={() => onSelectLesson(l)} 
                             className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 cursor-pointer hover:border-pink-300 hover:shadow-md transition-all slide-up"
                             style={{animationDelay: i * 0.1 + 's'}}>
                            <div className="flex justify-between items-center">
                                <div>
                                    <h3 className="text-xl font-bold text-slate-700">Lesson {l.id}: {l.title}</h3>
                                    <p className="text-slate-500 text-sm">{l.desc}</p>
                                </div>
                                <div className="bg-pink-100 text-pink-600 px-4 py-2 rounded-full font-bold text-sm">Start</div>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );
    };
	/* --- CHUNK 5: LESSON VIEW & APP LOGIC --- */

    const LessonView = ({ lesson, onBack }) => {
        const [tab, setTab] = useState('vocab'); // vocab, grammar, quiz
        const [quizIdx, setQuizIdx] = useState(0);
        const [score, setScore] = useState(0);
        const [showScore, setShowScore] = useState(false);

        const handleAnswer = (optIndex) => {
            if (optIndex === lesson.quiz[quizIdx].correct) setScore(s => s + 1);
            if (quizIdx + 1 < lesson.quiz.length) {
                setQuizIdx(q => q + 1);
            } else {
                setShowScore(true);
            }
        };

        return (
            <div className="max-w-3xl mx-auto p-6 h-full flex flex-col fade-in relative z-10">
                {/* Header */}
                <div className="flex items-center justify-between mb-6">
                    <button onClick={onBack} className="text-slate-400 hover:text-slate-600">‚úï Close</button>
                    <h2 className="font-bold text-slate-700">{lesson.title}</h2>
                    <div className="w-8"></div>
                </div>

                {/* Tabs */}
                <div className="flex bg-white rounded-xl p-1 shadow-sm mb-6">
                    {['vocab', 'grammar', 'quiz'].map(t => (
                        <button key={t} onClick={() => setTab(t)} 
                            className={`flex-1 py-2 rounded-lg text-sm font-bold capitalize transition-all ${tab === t ? 'bg-pink-500 text-white shadow-md' : 'text-slate-500 hover:bg-slate-50'}`}>
                            {t}
                        </button>
                    ))}
                </div>

                {/* Content */}
                <div className="flex-1 overflow-y-auto bg-white rounded-3xl shadow-sm p-8 border border-slate-100">
                    {tab === 'vocab' && (
                        <div className="space-y-4">
                            {lesson.vocab.map((v, i) => (
                                <div key={i} className="flex justify-between items-center border-b border-slate-50 py-3">
                                    <div>
                                        <div className="text-xl font-bold text-slate-800 jp">{v.jp}</div>
                                        <div className="text-xs text-slate-400">{v.romaji}</div>
                                    </div>
                                    <div className="text-slate-600 font-medium">{v.en}</div>
                                </div>
                            ))}
                        </div>
                    )}

                    {tab === 'grammar' && (
                        <div className="space-y-6">
                            {lesson.grammar.map((g, i) => (
                                <div key={i} className="bg-slate-50 p-5 rounded-xl">
                                    <h3 className="font-bold text-pink-500 mb-1">{g.title}</h3>
                                    <div className="text-xl text-slate-800 mb-2 jp">{g.rule}</div>
                                    <p className="text-sm text-slate-600 leading-relaxed">{g.expl}</p>
                                </div>
                            ))}
                        </div>
                    )}

                    {tab === 'quiz' && (
                        <div className="text-center h-full flex flex-col justify-center">
                            {!showScore ? (
                                <div className="slide-up">
                                    <div className="text-xs font-bold text-pink-400 mb-4">QUESTION {quizIdx + 1} / {lesson.quiz.length}</div>
                                    <h3 className="text-xl font-bold text-slate-800 mb-8">{lesson.quiz[quizIdx].q}</h3>
                                    <div className="space-y-3">
                                        {lesson.quiz[quizIdx].options.map((opt, i) => (
                                            <button key={i} onClick={() => handleAnswer(i)}
                                                className="w-full py-4 rounded-xl border-2 border-slate-100 font-bold text-slate-600 hover:border-pink-500 hover:bg-pink-50 transition-all">
                                                {opt}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            ) : (
                                <div className="slide-up">
                                    <div className="text-6xl mb-4">üéâ</div>
                                    <h2 className="text-2xl font-bold text-slate-800 mb-2">Quiz Complete!</h2>
                                    <p className="text-slate-500 mb-8">You scored {score} out of {lesson.quiz.length}</p>
                                    <button onClick={() => { setQuizIdx(0); setScore(0); setShowScore(false); }} 
                                        className="bg-slate-800 text-white px-8 py-3 rounded-xl font-bold hover:bg-slate-900">Try Again</button>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            </div>
        );
    };

    // --- MAIN APP ---
    const App = () => {
        const [view, setView] = useState('home'); 
        const [currentLevel, setCurrentLevel] = useState(null);
        const [currentLesson, setCurrentLesson] = useState(null);

        const handleLevelSelect = (lvl) => {
            if (lvl === "N5") {
                setCurrentLevel(lvl);
                setView('level');
            } else {
                alert("N4-N1 are coming soon!");
            }
        };

        const handleLessonSelect = (lesson) => {
            setCurrentLesson(lesson);
            setView('lesson');
        };

        return (
            <div className="h-full w-full relative">
                <SakuraBackground />
                
                {view === 'home' && (
                    <div className="h-full w-full flex flex-col items-center justify-center relative z-20">
                        <div className="text-center mb-12 slide-up">
                            <h1 className="text-7xl font-black text-slate-800 mb-2 tracking-tighter">
                                <span className="text-pink-500">Nihongo</span> Pro
                            </h1>
                            <p className="text-slate-500 text-lg font-light tracking-widest">ULTIMATE EDITION</p>
                        </div>
                        <div className="grid grid-cols-2 gap-6 max-w-2xl w-full px-6">
                            <button onClick={() => handleLevelSelect("N5")}
                                className="col-span-2 bg-white/80 backdrop-blur-md p-8 rounded-3xl border border-white/50 hover:bg-white hover:scale-[1.02] hover:shadow-xl transition-all group text-left">
                                <div className="text-2xl font-bold text-slate-800 mb-1 group-hover:text-pink-500 transition-colors">Start Lessons</div>
                                <div className="text-slate-500">Grammar, Vocab & Quizzes</div>
                            </button>
                            <button onClick={() => setView('kanji')}
                                className="col-span-2 bg-gradient-to-r from-slate-800 to-slate-900 text-white p-8 rounded-3xl hover:scale-[1.02] hover:shadow-2xl transition-all text-left relative overflow-hidden">
                                <div className="relative z-10">
                                    <div className="text-2xl font-bold mb-1 text-pink-300">Kanji Dictionary</div>
                                    <div className="text-slate-400">Master N5 Kanji with Memory Tricks</div>
                                </div>
                                <div className="absolute right-[-20px] bottom-[-20px] text-9xl opacity-10 font-black">Â≠ó</div>
                            </button>
                        </div>
                    </div>
                )}

                {view === 'kanji' && <KanjiDashboard onBack={() => setView('home')} />}
                {view === 'level' && <LessonDashboard level={currentLevel} onBack={() => setView('home')} onSelectLesson={handleLessonSelect} />}
                {view === 'lesson' && <LessonView lesson={currentLesson} onBack={() => setView('level')} />}
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>
