<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nihongo Pro | Ultimate Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;600;700&family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Quicksand', sans-serif; overflow: hidden; }
        .jp { font-family: 'Zen Maru Gothic', sans-serif; }
        
        /* SAKURA ANIMATION */
        .sakura-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; overflow: hidden; }
        .petal {
            position: absolute;
            background-color: #ffc0cb;
            border-radius: 100% 0% 100% 0%;
            opacity: 0.8;
            animation: fall linear infinite;
        }
        @keyframes fall {
            0% { transform: translate(0, -10vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.8; }
            100% { transform: translate(100px, 110vh) rotate(360deg); opacity: 0; }
        }

        /* UI ANIMATIONS */
        .fade-in { animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .slide-up { animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-50 via-white to-blue-50 h-[100dvh] w-screen relative text-slate-700">

    <div id="root" class="h-full w-full relative z-10"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
		        // --- SAKURA GENERATOR COMPONENT ---
        const SakuraBackground = () => {
            const petals = useMemo(() => {
                return [...Array(25)].map((_, i) => ({
                    id: i,
                    left: Math.random() * 100 + "%",
                    width: Math.random() * 10 + 10 + "px",
                    height: Math.random() * 10 + 10 + "px",
                    animationDuration: Math.random() * 5 + 8 + "s",
                    animationDelay: Math.random() * 5 + "s"
                }));
            }, []);

            return (
                <div className="sakura-container">
                    {petals.map(p => (
                        <div key={p.id} className="petal" style={{
                            left: p.left, width: p.width, height: p.height,
                            animationDuration: p.animationDuration, animationDelay: p.animationDelay
                        }} />
                    ))}
                </div>
            );
        };

        // --- DATABASE ENGINE ---
        const DATABASE = {
            levels: ["N5", "N4", "N3", "N2", "N1"],
            lessons: {
                "N5": [
                    { id: 1, title: "Identity & Greetings", desc: "X is Y, Self-intro", vocab: [{ kanji: "ÁßÅ", kana: "„Çè„Åü„Åó", romaji: "watashi", mean: "I/Myself" }, { kanji: "Â≠¶Áîü", kana: "„Åå„Åè„Åõ„ÅÑ", romaji: "gakusei", mean: "Student" }], grammar: [{ title: "X wa Y desu", formula: "X „ÅØ Y „Åß„Åô", explanation: "X is Y.", example: { jp: "ÁßÅ„ÅØÂ≠¶Áîü„Åß„Åô„ÄÇ", en: "I am a student." }}], tricks: [{ title: "Wa vs Ha", content: "Particle „ÅØ is read 'Wa'." }], quiz: [{ question: "Particle for topic?", options: ["ka", "wa", "no"], correct: 1 }] },
                    { id: 2, title: "Demonstratives", desc: "Kore, Sore, Are", vocab: [{ kanji: "„Åì„Çå", kana: "„Åì„Çå", romaji: "kore", mean: "This" }, { kanji: "„Åù„Çå", kana: "„Åù„Çå", romaji: "sore", mean: "That" }], grammar: [{ title: "Ko-So-A-Do", formula: "Kore/Sore/Are", explanation: "Near speaker/Near listener/Far from both.", example: { jp: "„Åù„Çå„ÅØÊú¨„Åß„Åô„ÄÇ", en: "That is a book." }}], tricks: [{ title: "Ko-So-A", content: "Ko (Here), So (There), A (Over there)." }], quiz: [{ question: "Which is near the listener?", options: ["Kore", "Sore", "Are"], correct: 1 }] },
                    { id: 3, title: "Locations", desc: "Koko, Asoko, Doko", vocab: [{ kanji: "„Åì„Åì", kana: "„Åì„Åì", romaji: "koko", mean: "Here" }, { kanji: "„Éà„Ç§„É¨", kana: "„Éà„Ç§„É¨", romaji: "toire", mean: "Toilet" }], grammar: [{ title: "Place wa doko?", formula: "X wa doko desu ka", explanation: "Where is X?", example: { jp: "„Éà„Ç§„É¨„ÅØ„Å©„Åì„Åß„Åô„Åã„ÄÇ", en: "Where is the toilet?" }}], tricks: [{ title: "Politeness", content: "Dochira is politer than Doko." }], quiz: [{ question: "Where is it?", options: ["Doko", "Dare", "Itsu"], correct: 0 }] },
                    { id: 4, title: "Time & Verbs", desc: "Time, Masu-form", vocab: [{ kanji: "‰ªä", kana: "„ÅÑ„Åæ", romaji: "ima", mean: "Now" }, { kanji: "Ëµ∑„Åç„Åæ„Åô", kana: "„Åä„Åç„Åæ„Åô", romaji: "okimasu", mean: "Wake up" }], grammar: [{ title: "Specific Time (Ni)", formula: "Time + ni + Verb", explanation: "Use 'ni' for specific clock time.", example: { jp: "6ÊôÇ„Å´Ëµ∑„Åç„Åæ„Åô„ÄÇ", en: "I wake at 6." }}], tricks: [{ title: "4 O'Clock", content: "It's Yo-ji, not Yon-ji." }], quiz: [{ question: "Particle for time?", options: ["ni", "de", "to"], correct: 0 }] },
                    { id: 5, title: "Movement", desc: "Going, Coming", vocab: [{ kanji: "Ë°å„Åç„Åæ„Åô", kana: "„ÅÑ„Åç„Åæ„Åô", romaji: "ikimasu", mean: "To go" }, { kanji: "ÈõªËªä", kana: "„Åß„Çì„Åó„ÇÉ", romaji: "densha", mean: "Train" }], grammar: [{ title: "Movement (e)", formula: "Place + e + ikimasu", explanation: "Use 'he' (read 'e') for direction.", example: { jp: "‰∫¨ÈÉΩ„Å∏Ë°å„Åç„Åæ„Åô„ÄÇ", en: "I go to Kyoto." }}], tricks: [{ title: "Particle E", content: "Write 'he', say 'e'." }], quiz: [{ question: "I go _ taxi.", options: ["ni", "de", "to"], correct: 1 }] },
                    { id: 6, title: "Direct Objects", desc: "Eating, Drinking", vocab: [{ kanji: "È£ü„Åπ„Åæ„Åô", kana: "„Åü„Åπ„Åæ„Åô", romaji: "tabemasu", mean: "To eat" }, { kanji: "Ê∞¥", kana: "„Åø„Åö", romaji: "mizu", mean: "Water" }], grammar: [{ title: "Object Marker (o)", formula: "Noun + o + Verb", explanation: "Marks the target of action.", example: { jp: "Ê∞¥„ÇíÈ£≤„Åø„Åæ„Åô„ÄÇ", en: "I drink water." }}], tricks: [{ title: "De for Action", content: "Place + DE + Action (Eat at home)." }], quiz: [{ question: "Particle for object?", options: ["ga", "wa", "o"], correct: 2 }] },
                    { id: 7, title: "Giving & Receiving", desc: "Tools, Agemasu", vocab: [{ kanji: "Êâã", kana: "„Å¶", romaji: "te", mean: "Hand" }, { kanji: "„ÅÇ„Åí„Åæ„Åô", kana: "„ÅÇ„Åí„Åæ„Åô", romaji: "agemasu", mean: "To give" }], grammar: [{ title: "Means (de)", formula: "Tool + de + Verb", explanation: "Using a tool.", example: { jp: "„ÅØ„Åó„ÅßÈ£ü„Åπ„Åæ„Åô„ÄÇ", en: "Eat with chopsticks." }}], tricks: [{ title: "Agemasu", content: "I give OUT." }], quiz: [{ question: "I write _ a pen.", options: ["de", "ni", "o"], correct: 0 }] },
					                    { id: 8, title: "Adjectives", desc: "Describing things", vocab: [{ kanji: "È´ò„ÅÑ", kana: "„Åü„Åã„ÅÑ", romaji: "takai", mean: "Expensive/High" }, { kanji: "Èùô„Åã", kana: "„Åó„Åö„Åã", romaji: "shizuka", mean: "Quiet" }], grammar: [{ title: "Na vs I", formula: "I-adj ends in 'i'.", explanation: "Na-adj needs 'na' before nouns.", example: { jp: "Èùô„Åã„Å™Áî∫", en: "A quiet town" }}], tricks: [{ title: "Kirei Trap", content: "Kirei is a NA adjective!" }], quiz: [{ question: "Negative of Samui?", options: ["Samukunai", "Samu janai"], correct: 0 }] },
                    { id: 9, title: "Likes & Skills", desc: "Suki, Kirai, Jouzu", vocab: [{ kanji: "Â•Ω„Åç", kana: "„Åô„Åç", romaji: "suki", mean: "Like" }, { kanji: "Ê≠å", kana: "„ÅÜ„Åü", romaji: "uta", mean: "Song" }], grammar: [{ title: "Ga Suki", formula: "Noun + ga + suki", explanation: "Use 'ga' for likes/skills.", example: { jp: "Ê≠å„ÅåÂ•Ω„Åç„Åß„Åô„ÄÇ", en: "I like songs." }}], tricks: [{ title: "Object is Liked", content: "In Japanese, the object is the subject (GA)." }], quiz: [{ question: "Particle for 'like'?", options: ["o", "ga", "wa"], correct: 1 }] },
                    { id: 10, title: "Existence", desc: "Imasu vs Arimasu", vocab: [{ kanji: "„ÅÑ„Åæ„Åô", kana: "„ÅÑ„Åæ„Åô", romaji: "imasu", mean: "Exist (Living)" }, { kanji: "„ÅÇ„Çä„Åæ„Åô", kana: "„ÅÇ„Çä„Åæ„Åô", romaji: "arimasu", mean: "Exist (Non-living)" }], grammar: [{ title: "Living Rule", formula: "Imasu (Alive) / Arimasu (Dead)", explanation: "People/Animals = Imasu.", example: { jp: "Áå´„Åå„ÅÑ„Åæ„Åô„ÄÇ", en: "There is a cat." }}], tricks: [{ title: "Plants", content: "Plants are alive but use Arimasu (Non-moving)." }], quiz: [{ question: "A taxi is there.", options: ["Imasu", "Arimasu"], correct: 1 }] },
                    { id: 11, title: "Counters", desc: "Counting things", vocab: [{ kanji: "‰∏Ä„Å§", kana: "„Å≤„Å®„Å§", romaji: "hitotsu", mean: "One thing" }, { kanji: "ÂàáÊâã", kana: "„Åç„Å£„Å¶", romaji: "kitte", mean: "Stamp" }], grammar: [{ title: "Native Numbers", formula: "Hitotsu, Futatsu...", explanation: "Used for general objects.", example: { jp: "„Çä„Çì„Åî„Çí‰∫å„Å§„Åè„Å†„Åï„ÅÑ„ÄÇ", en: "Two apples please." }}], tricks: [{ title: "No Particle", content: "Numbers don't need particles." }], quiz: [{ question: "Three things?", options: ["Mittsu", "San-ko"], correct: 0 }] },
                    { id: 12, title: "Comparison", desc: "Yori, Hou ga", vocab: [{ kanji: "ÂØí„ÅÑ", kana: "„Åï„ÇÄ„ÅÑ", romaji: "samui", mean: "Cold" }, { kanji: "Èõ™", kana: "„ÇÜ„Åç", romaji: "yuki", mean: "Snow" }], grammar: [{ title: "Comparison", formula: "A wa B yori...", explanation: "A is more... than B.", example: { jp: "‰∏≠ÂõΩ„ÅØÊó•Êú¨„Çà„ÇäÂ§ß„Åç„ÅÑ„Åß„Åô„ÄÇ", en: "China is bigger than Japan." }}], tricks: [{ title: "Yori", content: "Yori = Compared to." }], quiz: [{ question: "Past of Atsui?", options: ["Atsukatta", "Atsuideshita"], correct: 0 }] },
                    { id: 13, title: "Desires", desc: "Tai form", vocab: [{ kanji: "Ê¨≤„Åó„ÅÑ", kana: "„Åª„Åó„ÅÑ", romaji: "hoshii", mean: "Want (noun)" }, { kanji: "Ë°å„Åç„Åü„ÅÑ", kana: "„ÅÑ„Åç„Åü„ÅÑ", romaji: "ikitai", mean: "Want to go" }], grammar: [{ title: "Want to do", formula: "Verb-stem + tai desu", explanation: "Conjugates like an I-adjective.", example: { jp: "È£ü„Åπ„Åü„ÅÑ„Åß„Åô„ÄÇ", en: "I want to eat." }}], tricks: [{ title: "Tai logic", content: "Treat 'Tai' exactly like 'Takai'." }], quiz: [{ question: "I want to drink.", options: ["Nomu tai", "Nomitai"], correct: 1 }] },
                    { id: 14, title: "The TE Form", desc: "Conjugation", vocab: [{ kanji: "ÂæÖ„Å£„Å¶„Åè„Å†„Åï„ÅÑ", kana: "„Åæ„Å£„Å¶", romaji: "matte kudasai", mean: "Please wait" }], grammar: [{ title: "Making Requests", formula: "Te-form + kudasai", explanation: "Polite request.", example: { jp: "Êõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", en: "Please write." }}], tricks: [{ title: "Song", content: "Ki->Ite, Gi->Ide, Mi/Ni/Bi->Nde." }], quiz: [{ question: "Te-form of Yobimasu?", options: ["Yonde", "Yobite"], correct: 0 }] },
					                    {
                        id: 15, title: "Permissions & Rules", desc: "Te-mo ii, Te-wa ikemasen",
                        vocab: [{ kanji: "ÁΩÆ„Åç„Åæ„Åô", kana: "„Åä„Åç„Åæ„Åô", romaji: "okimasu", mean: "To put/place" }, { kanji: "‰Ωè„Åø„Åæ„Åô", kana: "„Åô„Åø„Åæ„Åô", romaji: "sumimasu", mean: "To live" }],
                        grammar: [
                            { title: "Permission", formula: "V-te + mo ii desu ka", explanation: "May I...?", example: { jp: "ÂÜôÁúü„ÇíÊíÆ„Å£„Å¶„ÇÇ„ÅÑ„ÅÑ„Åß„Åô„Åã„ÄÇ", en: "May I take a photo?" } },
                            { title: "Prohibition", formula: "V-te + wa ikemasen", explanation: "You must not...", example: { jp: "„Åì„Åì„ÅßÂê∏„Å£„Å¶„ÅØ„ÅÑ„Åë„Åæ„Åõ„Çì„ÄÇ", en: "You must not smoke here." } }
                        ],
                        tricks: [{ title: "Wa is HA", content: "In 'Te-wa ikemasen', the particle is written HA." }],
                        quiz: [{ question: "May I eat?", options: ["Tabete mo ii desu ka", "Tabete wa ikemasen ka"], correct: 0 }]
                    },
                    {
                        id: 16, title: "Sequences", desc: "Connecting sentences",
                        vocab: [{ kanji: "‰πó„Çä„Åæ„Åô", kana: "„ÅÆ„Çä„Åæ„Åô", romaji: "norimasu", mean: "Ride/Get on" }, { kanji: "Èôç„Çä„Åæ„Åô", kana: "„Åä„Çä„Åæ„Åô", romaji: "orimasu", mean: "Get off" }],
                        grammar: [
                            { title: "Sequence of Action", formula: "V-te, V-te, ...", explanation: "I did A, then B, then C.", example: { jp: "ÊúùËµ∑„Åç„Å¶„ÄÅ„ÅîÈ£Ø„ÇíÈ£ü„Åπ„Å¶„ÄÅË°å„Åç„Åæ„Åô„ÄÇ", en: "I wake up, eat, and go." } },
                            { title: "After doing", formula: "V-te + kara", explanation: "After finishing A, I do B.", example: { jp: "ÁµÇ„Çè„Å£„Å¶„Åã„Çâ„ÄÅÈ£ü„Åπ„Åæ„Åô„ÄÇ", en: "After finishing, I will eat." } }
                        ],
                        tricks: [{ title: "Adjectives too", content: "I-adj -> Kute (Takakute). Na-adj -> De (Shizuka de)." }],
                        quiz: [{ question: "Connect 'Ookii' (Big)", options: ["Ookikute", "Ookii de"], correct: 0 }]
                    },
                    {
                        id: 17, title: "The NAI Form", desc: "Must & Please don't",
                        vocab: [{ kanji: "ÂøÉÈÖç", kana: "„Åó„Çì„Å±„ÅÑ", romaji: "shinpai", mean: "Worry" }, { kanji: "ÊÆãÊ•≠", kana: "„Åñ„Çì„Åé„Çá„ÅÜ", romaji: "zangyou", mean: "Overtime work" }],
                        grammar: [
                            { title: "Please don't", formula: "V-nai + de kudasai", explanation: "Negative request.", example: { jp: "ÂÜôÁúü„ÇíÊíÆ„Çâ„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ", en: "Please don't take photos." } },
                            { title: "Obligation (Must)", formula: "V-nai (drop i) + kereba narimasen", explanation: "I must do...", example: { jp: "Ëñ¨„ÇíÈ£≤„Åæ„Å™„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì„ÄÇ", en: "I must take medicine." } }
                        ],
                        tricks: [{ title: "Nakereba Narimasen", content: "Lit: 'If I don't do it, it won't become.' = I must." }],
                        quiz: [{ question: "Nai form of 'Kakimasu'?", options: ["Kakinai", "Kakanai"], correct: 1 }]
                    },
                    {
                        id: 18, title: "Dictionary Form", desc: "Can do, Hobbies",
                        vocab: [{ kanji: "ÈÅãËª¢", kana: "„ÅÜ„Çì„Å¶„Çì", romaji: "unten", mean: "Driving" }, { kanji: "Ë∂£Âë≥", kana: "„Åó„ÇÖ„Åø", romaji: "shumi", mean: "Hobby" }],
                        grammar: [
                            { title: "Potential (Can)", formula: "V-dict + koto ga dekimasu", explanation: "I can do...", example: { jp: "Êº¢Â≠ó„ÇíË™≠„ÇÄ„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ", en: "I can read Kanji." } },
                            { title: "Before...", formula: "V-dict + mae ni", explanation: "Before doing X...", example: { jp: "ÂØù„ÇãÂâç„Å´Êú¨„ÇíË™≠„Åø„Åæ„Åô„ÄÇ", en: "I read before sleeping." } }
                        ],
                        tricks: [{ title: "Koto", content: "'Koto' turns a verb into a noun so particles can stick to it." }],
                        quiz: [{ question: "I can swim.", options: ["Oyogu dekimasu", "Oyogu koto ga dekimasu"], correct: 1 }]
                    },
                    {
                        id: 19, title: "The TA Form", desc: "Experience & Variety",
                        vocab: [{ kanji: "Áôª„Çä„Åæ„Åô", kana: "„ÅÆ„Åº„Çä„Åæ„Åô", romaji: "noborimasu", mean: "To climb" }, { kanji: "„Å™„Çä„Åæ„Åô", kana: "„Å™„Çä„Åæ„Åô", romaji: "narimasu", mean: "To become" }],
                        grammar: [
                            { title: "Experience", formula: "V-ta + koto ga arimasu", explanation: "I have done...", example: { jp: "È¶¨„Å´‰πó„Å£„Åü„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ", en: "I have ridden a horse." } },
                            { title: "Variety (Tari Tari)", formula: "V-ta + ri, V-ta + ri shimasu", explanation: "Do things like A and B.", example: { jp: "Êú¨„ÇíË™≠„Çì„Å†„Çä„ÄÅÂØù„Åü„Çä„Åó„Åæ„Åô„ÄÇ", en: "I do things like reading and sleeping." } }
                        ],
                        tricks: [{ title: "Ta Form", content: "Conjugates EXACTLY like the Te Form. Just change Te to Ta." }],
                        quiz: [{ question: "Have you eaten?", options: ["Tabeta koto ga arimasu ka", "Taberu koto ga arimasu ka"], correct: 0 }]
                    },
					                    {
                        id: 20, title: "Plain Style", desc: "Casual Speech",
                        vocab: [{ kanji: "Ë¶Å„Çä„Åæ„Åô", kana: "„ÅÑ„Çä„Åæ„Åô", romaji: "irimasu", mean: "Need (visa etc)" }, { kanji: "Ë™ø„Åπ„Çã", kana: "„Åó„Çâ„Åπ„Çã", romaji: "shiraberu", mean: "Check/Investigate" }],
                        grammar: [
                            { title: "Casual Style", formula: "Drop Masu/Desu", explanation: "Use Dictionary/Ta/Nai forms directly.", example: { jp: "ÊòéÊó•„ÄÅÊù±‰∫¨„Å∏Ë°å„ÅèÔºü", en: "Going to Tokyo tomorrow?" } },
                            { title: "But...", formula: "Kedo", explanation: "Replace 'Ga' with 'Kedo' in casual speech.", example: { jp: "ÁæéÂë≥„Åó„ÅÑ„Åë„Å©„ÄÅÈ´ò„ÅÑ„ÄÇ", en: "It's good, but expensive." } }
                        ],
                        tricks: [{ title: "Question Mark", content: "In casual speech, 'Ka' is dropped. Rise intonation instead." }],
                        quiz: [{ question: "Casual 'Tabemasu'", options: ["Taberu", "Tabero"], correct: 0 }]
                    },
                    {
                        id: 21, title: "Thoughts & Quotes", desc: "To omoimasu",
                        vocab: [{ kanji: "ÊÄù„ÅÑ„Åæ„Åô", kana: "„Åä„ÇÇ„ÅÑ„Åæ„Åô", romaji: "omoimasu", mean: "To think" }, { kanji: "Ë®Ä„ÅÑ„Åæ„Åô", kana: "„ÅÑ„ÅÑ„Åæ„Åô", romaji: "iimasu", mean: "To say" }],
                        grammar: [
                            { title: "I think...", formula: "Plain Form + to omoimasu", explanation: "Expressing opinion.", example: { jp: "ÊòéÊó•„ÅØÈõ®„Å†„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ", en: "I think it will rain tomorrow." } },
                            { title: "He said...", formula: "Plain Form + to iimashita", explanation: "Quoting someone.", example: { jp: "ÂΩº„ÅØ„ÄåË°å„Åè„Äç„Å®Ë®Ä„ÅÑ„Åæ„Åó„Åü„ÄÇ", en: "He said he would go." } }
                        ],
                        tricks: [{ title: "Da for Nouns", content: "For Nouns/Na-adj, add 'da' before 'to omoimasu'." }],
                        quiz: [{ question: "I think it is expensive.", options: ["Takai omoimasu", "Takai to omoimasu"], correct: 1 }]
                    },
                    {
                        id: 22, title: "Noun Modification", desc: "Relative Clauses",
                        vocab: [{ kanji: "ÁùÄ„Åæ„Åô", kana: "„Åç„Åæ„Åô", romaji: "kimasu", mean: "To wear (shirt)" }, { kanji: "Â∏ΩÂ≠ê", kana: "„Åº„ÅÜ„Åó", romaji: "boushi", mean: "Hat" }],
                        grammar: [
                            { title: "Relative Clause", formula: "Sentence + Noun", explanation: "Describing a noun with a verb phrase.", example: { jp: "„Åì„Çå„ÅØÁßÅ„ÅåÊíÆ„Å£„ÅüÂÜôÁúü„Åß„Åô„ÄÇ", en: "This is the photo I took." } },
                            { title: "Time to...", formula: "V-dict + jikan", explanation: "Time to do X.", example: { jp: "Êúù„Åî„ÅØ„Çì„ÇíÈ£ü„Åπ„ÇãÊôÇÈñì„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ", en: "I have no time to eat breakfast." } }
                        ],
                        tricks: [{ title: "No WA inside", content: "Inside a modifying clause, 'Wa' usually becomes 'Ga'." }],
                        quiz: [{ question: "The book I bought.", options: ["Watashi ga katta hon", "Watashi wa kau hon"], correct: 0 }]
                    },
                    {
                        id: 23, title: "When & If", desc: "Toki, To",
                        vocab: [{ kanji: "Âõû„Åó„Åæ„Åô", kana: "„Åæ„Çè„Åó„Åæ„Åô", romaji: "mawashimasu", mean: "Turn (knob)" }, { kanji: "‰ø°Âè∑", kana: "„Åó„Çì„Åî„ÅÜ", romaji: "shingou", mean: "Traffic light" }],
                        grammar: [
                            { title: "When...", formula: "V-dict/V-ta + toki", explanation: "Use Dict for 'before', Ta for 'after'.", example: { jp: "ÂÆ∂„Å∏Â∏∞„Çã„Å®„Åç„ÄÅË≤∑„ÅÑ„Åæ„Åó„Åü„ÄÇ", en: "I bought it on the way home." } },
                            { title: "Inevitable If", formula: "V-dict + to", explanation: "If you do A, B happens naturally (machines/nature).", example: { jp: "Âè≥„Å∏Âõû„Åô„Å®„ÄÅÈü≥„ÅåÂ§ß„Åç„Åè„Å™„Çä„Åæ„Åô„ÄÇ", en: "If you turn right, volume goes up." } }
                        ],
                        tricks: [{ title: "Toki Timing", content: "Iku toki (Before I go). Itta toki (After I went)." }],
                        quiz: [{ question: "When I was a child...", options: ["Kodomo no toki", "Kodomo na toki"], correct: 0 }]
                    },
                    {
                        id: 24, title: "Giving & Receiving II", desc: "Kuremasu",
                        vocab: [{ kanji: "„Åè„Çå„Åæ„Åô", kana: "„Åè„Çå„Åæ„Åô", romaji: "kuremasu", mean: "Give (to me)" }, { kanji: "Áõ¥„Åó„Åæ„Åô", kana: "„Å™„Åä„Åó„Åæ„Åô", romaji: "naoshimasu", mean: "Repair" }],
                        grammar: [
                            { title: "Gave to ME", formula: "Giver wa Watashi ni Kuremasu", explanation: "Agemasu is me to others. Kuremasu is others to me.", example: { jp: "‰ΩêËó§„Åï„Çì„ÅØÁßÅ„Å´Ëä±„Çí„Åè„Çå„Åæ„Åó„Åü„ÄÇ", en: "Ms. Sato gave me flowers." } },
                            { title: "Kind Actions", formula: "V-te + moraimasu/kuremasu", explanation: "Receiving a favor.", example: { jp: "Áî∞‰∏≠„Åï„Çì„ÅåÈÄÅ„Å£„Å¶„Åè„Çå„Åæ„Åó„Åü„ÄÇ", en: "Mr. Tanaka (kindly) sent me." } }
                        ],
                        tricks: [{ title: "Kuremasu", content: "Think 'Come'. It comes to me." }],
                        quiz: [{ question: "He helped me.", options: ["Tetsudatte kuremashita", "Tetsudatte agemashita"], correct: 0 }]
                    },
                    {
                        id: 25, title: "Conditionals", desc: "Tara, Temo",
                        vocab: [{ kanji: "ËÄÉ„Åà„Åæ„Åô", kana: "„Åã„Çì„Åå„Åà„Åæ„Åô", romaji: "kangaemasu", mean: "Think/Consider" }, { kanji: "ÈßÖ", kana: "„Åà„Åç", romaji: "eki", mean: "Station" }],
                        grammar: [
                            { title: "If (Tara)", formula: "V-ta + ra", explanation: "General conditional. If/When.", example: { jp: "Èõ®„ÅåÈôç„Å£„Åü„Çâ„ÄÅË°å„Åç„Åæ„Åõ„Çì„ÄÇ", en: "If it rains, I won't go." } },
                            { title: "Even if (Temo)", formula: "V-te + mo", explanation: "Even if X, Y.", example: { jp: "È´ò„Åè„Å¶„ÇÇ„ÄÅË≤∑„ÅÑ„Åæ„Åô„ÄÇ", en: "Even if expensive, I will buy it." } }
                        ],
                        tricks: [{ title: "Tara is King", content: "'Tara' is the safest 'If' to use in most daily situations." }],
                        quiz: [{ question: "If I have money...", options: ["Okane ga attara", "Okane ga attemo"], correct: 0 }]
                    }
                ]
            }
        };
		        // --- COMPONENTS ---

        // 1. Level Selector (Home)
        const LevelSelect = ({ onSelect }) => (
            <div className="h-full w-full overflow-y-auto flex flex-col items-center justify-center p-4 fade-in relative z-10">
                <SakuraBackground />
                <div className="w-full max-w-5xl text-center my-auto py-10 glass-panel rounded-3xl shadow-2xl p-8 md:p-12">
                    <div className="mb-8">
                        <span className="inline-block py-1 px-3 rounded-full bg-pink-100 text-pink-600 text-sm font-bold tracking-wider mb-2">ULTIMATE EDITION</span>
                        <h1 className="text-5xl md:text-7xl font-extrabold mb-2 text-slate-800 tracking-tight">NIHONGO <span className="text-pink-500">PRO</span></h1>
                        <p className="text-slate-500 text-lg md:text-xl font-medium">Master Minna no Nihongo (L1 - L25)</p>
                    </div>
                    
                    <div className="grid grid-cols-1 sm:grid-cols-5 gap-4 w-full">
                        {DATABASE.levels.map((lvl) => (
                            <button 
                                key={lvl}
                                onClick={() => onSelect(lvl)}
                                className={`group relative p-6 rounded-2xl border-2 transition-all duration-300 overflow-hidden ${lvl === 'N5' ? 'border-pink-400 bg-white/80 shadow-lg hover:shadow-pink-200/50 hover:-translate-y-1 cursor-pointer' : 'border-slate-200 bg-slate-50/50 text-slate-300 cursor-not-allowed'}`}
                            >
                                <div className={`absolute inset-0 bg-pink-500 opacity-0 ${lvl === 'N5' ? 'group-hover:opacity-5' : ''} transition-opacity`}></div>
                                <span className={`text-3xl font-bold relative z-10 ${lvl === 'N5' ? 'text-slate-800' : ''}`}>{lvl}</span>
                                {lvl === 'N5' && <div className="text-xs text-pink-500 font-bold mt-1">UNLOCKED</div>}
                            </button>
                        ))}
                    </div>
                    <div className="mt-8 text-slate-400 text-sm">
                        Contains {DATABASE.lessons["N5"].length} Lessons ‚Ä¢ Grammar ‚Ä¢ Vocab ‚Ä¢ Quizzes
                    </div>
                </div>
            </div>
        );
		        // 2. Lesson Dashboard
        const LessonDashboard = ({ level, onBack, onSelectLesson }) => (
            <div className="h-full flex flex-col fade-in relative z-10">
                <SakuraBackground />
                <div className="flex-none p-4 md:p-6 glass-panel border-b border-white/40 flex items-center justify-between z-20 shadow-sm backdrop-blur-md">
                    <button onClick={onBack} className="text-slate-500 hover:text-pink-600 font-bold px-4 py-2 rounded-full hover:bg-pink-50 transition-colors">‚Üê Back</button>
                    <h2 className="text-xl font-bold text-slate-800">{level} CURRICULUM</h2>
                    <div className="w-12"></div>
                </div>
                
                <div className="flex-1 overflow-y-auto p-4 md:p-8 scroll-smooth">
                    <div className="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 pb-24">
                        {DATABASE.lessons[level].map((lesson, idx) => (
                            <div 
                                key={lesson.id} 
                                onClick={() => onSelectLesson(lesson)}
                                className="group relative p-6 bg-white/90 backdrop-blur-sm rounded-2xl border border-white shadow-sm transition-all hover:border-pink-300 hover:shadow-xl hover:shadow-pink-100/50 hover:-translate-y-1 cursor-pointer flex flex-col justify-between h-48"
                            >
                                <div>
                                    <div className="flex justify-between items-start mb-2">
                                        <span className="text-xs font-bold tracking-wider text-white bg-pink-400 px-2 py-1 rounded-md shadow-sm">LESSON {lesson.id}</span>
                                        <span className="text-slate-300 group-hover:text-pink-400 text-2xl">‚ûî</span>
                                    </div>
                                    <h3 className="text-xl font-bold text-slate-800 mb-2 line-clamp-1">{lesson.title}</h3>
                                    <p className="text-sm text-slate-500 leading-relaxed line-clamp-2">{lesson.desc}</p>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            </div>
        );

        // 3. Active Lesson View
        const LessonView = ({ lesson, onBack }) => {
            const [activeTab, setActiveTab] = useState('vocab');
            const [quizScore, setQuizScore] = useState(null);

            const tabs = [
                { id: 'vocab', label: 'Vocab', icon: 'Aa' },
                { id: 'grammar', label: 'Grammar', icon: '¬∂' },
                { id: 'tricks', label: 'Tricks', icon: 'üí°' },
                { id: 'quiz', label: 'Quiz', icon: '?' }
            ];

            return (
                <div className="h-full flex flex-col bg-slate-50 fade-in w-full relative z-20">
                    {/* Header */}
                    <div className="flex-none bg-white/95 backdrop-blur-md border-b border-slate-200 px-4 py-3 md:px-6 md:py-4 flex flex-col md:flex-row items-center justify-between shadow-sm z-30 gap-3">
                        <div className="w-full md:w-auto flex justify-between items-center">
                            <button onClick={onBack} className="text-sm font-bold text-slate-500 hover:text-pink-600 px-3 py-1 rounded-md hover:bg-pink-50 transition-colors">‚úï Close</button>
                            <span className="md:hidden font-bold text-slate-800">L{lesson.id}</span>
                            <div className="w-8 md:hidden"></div> 
                        </div>
                        
                        <h2 className="hidden md:block font-bold text-lg text-slate-800">L{lesson.id}: {lesson.title}</h2>
                        
                        <div className="flex bg-slate-100/80 rounded-xl p-1 w-full md:w-auto overflow-x-auto no-scrollbar">
                            {tabs.map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex-1 md:flex-none px-6 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${activeTab === tab.id ? 'bg-white text-pink-500 shadow-md transform scale-105' : 'text-slate-500 hover:text-slate-700 hover:bg-white/50'}`}
                                >
                                    {tab.label}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Content */}
                    <div className="flex-1 overflow-y-auto p-4 md:p-8 w-full bg-slate-50/50">
                        <div className="max-w-3xl mx-auto pb-24 slide-up">
                            
                            {/* VOCAB */}
                            {activeTab === 'vocab' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {lesson.vocab.map((word, i) => (
                                        <div key={i} className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm flex items-center justify-between hover:border-pink-200 transition-colors">
                                            <div>
                                                <p className="jp text-3xl font-bold text-slate-800 mb-1">{word.kanji}</p>
                                                <p className="text-xs font-bold text-pink-400 uppercase tracking-wide">{word.romaji}</p>
                                                <p className="text-xs text-slate-400">{word.kana}</p>
                                            </div>
                                            <p className="font-semibold text-slate-600 text-sm text-right max-w-[50%]">{word.mean}</p>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* GRAMMAR */}
                            {activeTab === 'grammar' && (
                                <div className="space-y-8">
                                    {lesson.grammar.map((point, i) => (
                                        <div key={i} className="bg-white p-8 rounded-3xl border border-slate-100 shadow-md relative overflow-hidden">
                                            <div className="absolute top-0 left-0 w-2 h-full bg-pink-400"></div>
                                            <h3 className="text-xl font-bold text-slate-800 mb-4">{point.title}</h3>
                                            <div className="bg-slate-100 px-4 py-3 rounded-xl font-mono text-sm text-pink-600 mb-4 inline-block font-bold border border-slate-200 shadow-inner">
                                                {point.formula}
                                            </div>
                                            <p className="text-slate-600 mb-6 text-base leading-relaxed">{point.explanation}</p>
                                            <div className="bg-pink-50/50 p-5 rounded-2xl border border-pink-100">
                                                <p className="jp text-lg font-bold text-slate-800 mb-1">{point.example.jp}</p>
                                                <p className="text-sm text-slate-500 italic">{point.example.en}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* TRICKS */}
                            {activeTab === 'tricks' && (
                                <div className="space-y-4">
                                    {lesson.tricks.map((trick, i) => (
                                        <div key={i} className="bg-yellow-50 p-6 rounded-2xl border border-yellow-200 flex gap-4 items-start shadow-sm">
                                            <span className="text-3xl filter drop-shadow-sm">üí°</span>
                                            <div>
                                                <h3 className="font-bold text-yellow-900 text-lg mb-1">{trick.title}</h3>
                                                <p className="text-yellow-800 leading-relaxed">{trick.content}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
							                            {/* QUIZ */}
                            {activeTab === 'quiz' && (
                                <div>
                                    {quizScore === null ? (
                                        <QuizComponent questions={lesson.quiz} onFinish={setQuizScore} />
                                    ) : (
                                        <div className="text-center py-20 bg-white rounded-3xl shadow-xl border border-slate-100 mx-auto max-w-md slide-up">
                                            <div className="text-8xl mb-6 animate-bounce">üéâ</div>
                                            <h3 className="text-3xl font-bold text-slate-800 mb-2">Lesson Complete!</h3>
                                            <p className="text-slate-500 mb-8 text-lg">You scored <span className="text-pink-500 font-bold">{quizScore}</span> / {lesson.quiz.length}</p>
                                            <button 
                                                onClick={() => { setQuizScore(null); setActiveTab('vocab'); }}
                                                className="bg-pink-500 text-white px-10 py-4 rounded-full font-bold shadow-lg shadow-pink-200 hover:bg-pink-600 hover:scale-105 transition-all"
                                            >
                                                Review Again
                                            </button>
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        const QuizComponent = ({ questions, onFinish }) => {
            const [answers, setAnswers] = useState({});
            
            const handleSubmit = () => {
                let score = 0;
                questions.forEach((q, idx) => { if (answers[idx] === q.correct) score++; });
                onFinish(score);
            };

            return (
                <div className="space-y-6">
                    {questions.map((q, qIdx) => (
                        <div key={qIdx} className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm transition-all hover:shadow-md">
                            <h4 className="font-bold text-slate-800 mb-4 text-lg flex items-center">
                                <span className="bg-slate-100 text-slate-500 w-8 h-8 rounded-full flex items-center justify-center text-sm mr-3">{qIdx + 1}</span>
                                {q.question}
                            </h4>
                            <div className="space-y-3 pl-11">
                                {q.options.map((opt, oIdx) => (
                                    <label key={oIdx} className={`flex items-center p-4 rounded-xl border-2 cursor-pointer transition-all ${answers[qIdx] === oIdx ? 'border-pink-500 bg-pink-50' : 'border-slate-100 hover:border-pink-200 hover:bg-slate-50'}`}>
                                        <input type="radio" name={`q-${qIdx}`} value={oIdx} onChange={() => setAnswers({...answers, [qIdx]: oIdx})} className="w-5 h-5 text-pink-600 accent-pink-500"/>
                                        <span className={`ml-3 font-medium ${answers[qIdx] === oIdx ? 'text-pink-900' : 'text-slate-600'}`}>{opt}</span>
                                    </label>
                                ))}
                            </div>
                        </div>
                    ))}
                    <button onClick={handleSubmit} disabled={Object.keys(answers).length < questions.length} className="w-full bg-slate-800 text-white py-5 rounded-2xl font-bold text-xl disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-900 hover:shadow-xl transition-all mt-8">Check Answers</button>
                </div>
            )
        }

        // --- APP ROOT ---
        const App = () => {
            const [view, setView] = useState('home');
            const [currentLevel, setCurrentLevel] = useState(null);
            const [currentLesson, setCurrentLesson] = useState(null);

            const handleLevelSelect = (lvl) => {
                if (lvl === "N5") {
                    setCurrentLevel(lvl);
                    setView('level');
                } else {
                    alert("N4-N1 are locked in this demo!");
                }
            };

            const handleLessonSelect = (lesson) => {
                setCurrentLesson(lesson);
                setView('lesson');
            };

            return (
                <div className="h-full w-full">
                    {view === 'home' && <LevelSelect onSelect={handleLevelSelect} />}
                    {view === 'level' && <LessonDashboard level={currentLevel} onBack={() => setView('home')} onSelectLesson={handleLessonSelect} />}
                    {view === 'lesson' && <LessonView lesson={currentLesson} onBack={() => setView('level')} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
